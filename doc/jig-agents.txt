*jig-agents*  Jig Agent UX + Transactional Edit Surface (WP-17)

OVERVIEW
  WP-17 extends the optional agent layer with:
    - approval queue visibility + statusline indicator
    - transactional patch/diff pipeline
    - context ledger source management and budget enforcement
    - instruction source precedence + disable/enable controls

DEFAULTS
  - agent module disabled by default
  - no startup auto-network
  - no MCP or agent autostart on startup
  - safe profile (`NVIM_APPNAME=jig-safe`) does not load agent modules

ENABLEMENT
  Set in trusted user config:
    vim.g.jig_agent = { enabled = true }

APPROVAL UX
  :JigAgentApprovals
  :JigAgentApprovalResolve <approval_id> <allow|deny|allow-always|deny-always> [global|project|task] [scope_value]

  Any policy `ask` result enqueues a pending approval and updates chrome indicator.

TRANSACTIONAL PATCH PIPELINE
  :JigPatchCreate <json_patch_spec>
  :JigPatchSessions
  :JigPatchReview [session_id]
  :JigPatchHunkShow <session_id> <file_index> <hunk_index>
  :JigPatchHunkAccept <session_id> <file_index> <hunk_index>
  :JigPatchHunkReject <session_id> <file_index> <hunk_index>
  :JigPatchApplyAll [session_id]
  :JigPatchDiscardAll [session_id]
  :JigPatchApply [session_id]
  :JigPatchRollback [session_id]

  Boundary: direct writes outside patch pipeline are denied and logged.

CONTEXT LEDGER
  :JigAgentContext
  :JigAgentContextAdd <id> <bytes> [kind] [label]
  :JigAgentContextRemove <source_id>
  :JigAgentContextReset

INSTRUCTION INTEROPERABILITY
  :JigAgentInstructions
  :JigAgentInstructionDisable <source_id|path>
  :JigAgentInstructionEnable <source_id|path>

  Precedence defaults: project > user > global.
  Source toggles are persisted and auditable.

WP-09 SURFACES (UNCHANGED)
  MCP:
    :JigMcpList
    :JigMcpTrust
    :JigMcpStart <server>
    :JigMcpStop <server>|all
    :JigMcpTools <server>
    :JigMcpCall <server> <tool> <json_args>

  Policy:
    :JigAgentPolicyList
    :JigAgentPolicyGrant <allow|ask|deny> <tool> <action_class> <target> <scope> [scope_value]
    :JigAgentPolicyRevoke <rule_id>

  Tasks and logs:
    :JigAgentTaskStart [title]
    :JigAgentTaskCancel <task_id>
    :JigAgentTaskResume <task_id>
    :JigAgentTasks
    :JigAgentLogTail [count]

  ACP hooks:
    :JigAcpHandshake <json_spec>
    :JigAcpPrompt <json_spec> <prompt>

CHECKS
  tests/agent/run_harness.sh
  tests/agent_ui/run_harness.sh
  :checkhealth jig

vim:tw=78:ts=8:noet:ft=help:norl:
